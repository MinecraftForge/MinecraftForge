--- ../src_base/minecraft/net/minecraft/item/ItemLeash.java
+++ ../src_work/minecraft/net/minecraft/item/ItemLeash.java
@@ -9,6 +9,8 @@
 import net.minecraft.entity.player.EntityPlayer;
 import net.minecraft.util.AxisAlignedBB;
 import net.minecraft.world.World;
+
+import org.bukkit.event.hanging.HangingPlaceEvent; // CraftBukkit
 
 public class ItemLeash extends Item
 {
@@ -46,7 +48,7 @@
 
     public static boolean func_135066_a(EntityPlayer par0EntityPlayer, World par1World, int par2, int par3, int par4)
     {
-        EntityLeashKnot entityleashknot = EntityLeashKnot.func_110130_b(par1World, par2, par3, par4);
+        EntityLeashKnot entityleashknot = EntityLeashKnot.getKnotForBlock(par1World, par2, par3, par4);
         boolean flag = false;
         double d0 = 7.0D;
         List list = par1World.getEntitiesWithinAABB(EntityLiving.class, AxisAlignedBB.getAABBPool().getAABB((double)par2 - d0, (double)par3 - d0, (double)par4 - d0, (double)par2 + d0, (double)par3 + d0, (double)par4 + d0));
@@ -59,14 +61,32 @@
             {
                 EntityLiving entityliving = (EntityLiving)iterator.next();
 
-                if (entityliving.func_110167_bD() && entityliving.func_110166_bE() == par0EntityPlayer)
+                if (entityliving.getLeashed() && entityliving.getLeashedToEntity() == par0EntityPlayer)
                 {
                     if (entityleashknot == null)
                     {
                         entityleashknot = EntityLeashKnot.func_110129_a(par1World, par2, par3, par4);
+                        // CraftBukkit start
+                        HangingPlaceEvent event = new HangingPlaceEvent((org.bukkit.entity.Hanging) entityleashknot.getBukkitEntity(), par0EntityPlayer != null ? (org.bukkit.entity.Player) par0EntityPlayer.getBukkitEntity() : null, par1World.getWorld().getBlockAt(par2, par3, par4), org.bukkit.block.BlockFace.SELF);
+                        par1World.getServer().getPluginManager().callEvent(event);
+
+                        if (event.isCancelled())
+                        {
+                            entityleashknot.setDead();
+                            return false;
+                        }
+
+                        // CraftBukkit end
                     }
 
-                    entityliving.func_110162_b(entityleashknot, true);
+                    // CraftBukkit start
+                    if (org.bukkit.craftbukkit.event.CraftEventFactory.callPlayerLeashEntityEvent(entityliving, entityleashknot, par0EntityPlayer).isCancelled())
+                    {
+                        continue;
+                    }
+
+                    // CraftBukkit end
+                    entityliving.setLeashedToEntity(entityleashknot, true);
                     flag = true;
                 }
             }
