--- a/net/minecraft/server/integrated/IntegratedServer.java
+++ b/net/minecraft/server/integrated/IntegratedServer.java
@@ -49,7 +49,7 @@
    private UUID field_211528_n;
 
    public IntegratedServer(Minecraft p_i46523_1_, String p_i46523_2_, String p_i46523_3_, WorldSettings p_i46523_4_, YggdrasilAuthenticationService p_i46523_5_, MinecraftSessionService p_i46523_6_, GameProfileRepository p_i46523_7_, PlayerProfileCache p_i46523_8_) {
-      super(new File(p_i46523_1_.field_71412_D, "saves"), p_i46523_1_.func_110437_J(), p_i46523_1_.func_184126_aj(), new Commands(false), p_i46523_5_, p_i46523_6_, p_i46523_7_, p_i46523_8_);
+      super(new File(p_i46523_1_.field_71412_D, "saves"), p_i46523_1_.func_110437_J(), new Commands(false), p_i46523_5_, p_i46523_6_, p_i46523_7_, p_i46523_8_);
       this.func_71224_l(p_i46523_1_.func_110432_I().func_111285_a());
       this.func_71261_m(p_i46523_2_);
       this.func_71246_n(p_i46523_3_);
@@ -91,9 +91,10 @@
       this.func_71245_h(true);
       field_147148_h.info("Generating keypair");
       this.func_71253_a(CryptManager.func_75891_b());
+      if (!net.minecraftforge.fml.server.ServerLifecycleHooks.handleServerAboutToStart(this)) return false;
       this.func_71247_a(this.func_71270_I(), this.func_71221_J(), this.field_71350_m.func_77160_d(), this.field_71350_m.func_77165_h(), this.field_71350_m.func_205391_j());
       this.func_71205_p(this.func_71214_G() + " - " + this.func_71218_a(DimensionType.OVERWORLD).func_72912_H().func_76065_j());
-      return true;
+      return net.minecraftforge.fml.server.ServerLifecycleHooks.handleServerStarting(this);
    }
 
    public void func_71217_p(BooleanSupplier p_71217_1_) {
@@ -146,6 +147,7 @@
    }
 
    public EnumDifficulty func_147135_j() {
+      if (this.field_71349_l.field_71441_e == null) return this.field_71349_l.field_71474_y.field_74318_M; // Fix NPE just in case.
       return this.field_71349_l.field_71441_e.func_72912_H().func_176130_y();
    }
 
@@ -245,6 +247,7 @@
    }
 
    public void func_71263_m() {
+      if (func_71278_l())
       Futures.getUnchecked(this.func_152344_a(() -> {
          for(EntityPlayerMP entityplayermp : Lists.newArrayList(this.func_184103_al().func_181057_v())) {
             if (!entityplayermp.func_110124_au().equals(this.field_211528_n)) {
