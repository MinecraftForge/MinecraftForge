--- a/net/minecraft/server/network/NetHandlerHandshakeTCP.java
+++ b/net/minecraft/server/network/NetHandlerHandshakeTCP.java
@@ -19,6 +19,7 @@
    }
 
    public void processHandshake(CPacketHandshake packetIn) {
+      if (!net.minecraftforge.fml.server.ServerLifecycleHooks.handleServerLogin(packetIn, this.networkManager)) return;
       switch(packetIn.getRequestedState()) {
       case LOGIN:
          this.networkManager.setConnectionState(EnumConnectionState.LOGIN);
