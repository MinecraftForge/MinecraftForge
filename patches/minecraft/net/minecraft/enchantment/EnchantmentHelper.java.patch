--- ../src-base/minecraft/net/minecraft/enchantment/EnchantmentHelper.java
+++ ../src-work/minecraft/net/minecraft/enchantment/EnchantmentHelper.java
@@ -143,11 +143,14 @@
         return field_77520_b.field_77497_a;
     }
 
+
+    @Deprecated //Use #getModifierForCreature(ItemStack, Entity) instead
     public static float func_152377_a(ItemStack p_152377_0_, EnumCreatureAttribute p_152377_1_)
     {
         field_77521_c.field_77495_a = 0.0F;
         field_77521_c.field_77494_b = p_152377_1_;
         func_77518_a(field_77521_c, p_152377_0_);
+        field_77521_c.field_77494_b = null;
         return field_77521_c.field_77495_a;
     }
 
@@ -302,7 +305,7 @@
     public static int func_77514_a(Random p_77514_0_, int p_77514_1_, int p_77514_2_, ItemStack p_77514_3_)
     {
         Item item = p_77514_3_.func_77973_b();
-        int i = item.func_77619_b();
+        int i = item.getItemEnchantability(p_77514_3_);
 
         if (i <= 0)
         {
@@ -357,7 +360,7 @@
     {
         List<EnchantmentData> list = Lists.<EnchantmentData>newArrayList();
         Item item = p_77513_1_.func_77973_b();
-        int i = item.func_77619_b();
+        int i = item.getItemEnchantability(p_77513_1_);
 
         if (i <= 0)
         {
@@ -413,7 +416,7 @@
 
         for (Enchantment enchantment : Enchantment.field_185264_b)
         {
-            if ((!enchantment.func_185261_e() || p_185291_2_) && (enchantment.field_77351_y.func_77557_a(item) || flag))
+            if ((!enchantment.func_185261_e() || p_185291_2_) && (enchantment.canApplyAtEnchantingTable(p_185291_1_) || (flag && enchantment.isAllowedOnBooks())))
             {
                 for (int i = enchantment.func_77325_b(); i > enchantment.func_77319_d() - 1; --i)
                 {
@@ -429,6 +432,26 @@
         return list;
     }
 
+    /* ======================================== FORGE START =====================================*/
+
+    /**
+     * Calculate the damage the enchantments of the given ItemStack add to the attack on the given entity.
+     *
+     * @param stack the itemstack used for attacking
+     * @param entity the entity being attacked
+     * @return the additional damage to do
+     */
+    public static float getModifierForCreature(ItemStack stack, @javax.annotation.Nullable Entity entity)
+    {
+        field_77521_c.field_77495_a = 0.0F;
+        field_77521_c.entity = entity;
+        func_77518_a(field_77521_c, stack);
+        field_77521_c.entity = null;
+        return field_77521_c.field_77495_a;
+    }
+
+    /* ======================================== FORGE END =====================================*/
+
     static final class DamageIterator implements EnchantmentHelper.IModifier
         {
             public EntityLivingBase field_151366_a;
@@ -482,7 +505,8 @@
     static final class ModifierLiving implements EnchantmentHelper.IModifier
         {
             public float field_77495_a;
-            public EnumCreatureAttribute field_77494_b;
+            public @javax.annotation.Nullable Entity entity;
+            public @javax.annotation.Nullable EnumCreatureAttribute field_77494_b;
 
             private ModifierLiving()
             {
@@ -490,7 +514,7 @@
 
             public void func_77493_a(Enchantment p_77493_1_, int p_77493_2_)
             {
-                this.field_77495_a += p_77493_1_.func_152376_a(p_77493_2_, this.field_77494_b);
+                this.field_77495_a += field_77494_b == null ? p_77493_1_.calcDamageByEntity(p_77493_2_, this.entity) : p_77493_1_.func_152376_a(p_77493_2_,field_77494_b);//Check attribute instead of entity if set for compatibility
             }
         }
 }
