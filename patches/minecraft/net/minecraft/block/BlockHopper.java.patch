--- ../src_base/minecraft/net/minecraft/block/BlockHopper.java
+++ ../src_work/minecraft/net/minecraft/block/BlockHopper.java
@@ -161,7 +161,9 @@
     }
 
     /**
-     * ejects contained items into the world, and notifies neighbours of an update, as appropriate
+     * Called on server worlds only when the block has been replaced by a different block ID, or the same block with a
+     * different metadata value, but before the new metadata value is set. Args: World, x, y, z, old block ID, old
+     * metadata
      */
     public void breakBlock(World par1World, int par2, int par3, int par4, int par5, int par6)
     {
@@ -238,7 +240,7 @@
 
     public static int getDirectionFromMetadata(int par0)
     {
-        return par0 & 7;
+        return Math.min(par0 & 7, 5); // CraftBukkit - Fix AIOOBE in callers
     }
 
     @SideOnly(Side.CLIENT)
