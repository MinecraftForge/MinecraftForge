--- ../src_base/minecraft/net/minecraft/block/BlockFire.java
+++ ../src_work/minecraft/net/minecraft/block/BlockFire.java
@@ -11,6 +11,14 @@
 import net.minecraft.world.World;
 import net.minecraft.world.WorldProviderEnd;
 
+import net.minecraftforge.common.ForgeDirection;
+import static net.minecraftforge.common.ForgeDirection.*;
+// CraftBukkit start
+import org.bukkit.craftbukkit.event.CraftEventFactory;
+import org.bukkit.event.block.BlockBurnEvent;
+import org.bukkit.event.block.BlockSpreadEvent;
+// CraftBukkit end
+
 public class BlockFire extends Block
 {
     /** The chance this block will encourage nearby blocks to catch on fire */
@@ -36,6 +44,8 @@
      */
     public void initializeBlock()
     {
+        abilityToCatchFire = Block.blockFlammability;
+        chanceToEncourageFire = Block.blockFireSpreadSpeed;
         this.setBurnRate(Block.planks.blockID, 5, 20);
         this.setBurnRate(Block.woodDoubleSlab.blockID, 5, 20);
         this.setBurnRate(Block.woodSingleSlab.blockID, 5, 20);
@@ -51,8 +61,8 @@
         this.setBurnRate(Block.tallGrass.blockID, 60, 100);
         this.setBurnRate(Block.cloth.blockID, 30, 60);
         this.setBurnRate(Block.vine.blockID, 15, 100);
-        this.setBurnRate(Block.field_111034_cE.blockID, 5, 5);
-        this.setBurnRate(Block.field_111038_cB.blockID, 60, 20);
+        this.setBurnRate(Block.coalBlock.blockID, 5, 5);
+        this.setBurnRate(Block.hay.blockID, 60, 20);
     }
 
     /**
@@ -62,8 +72,7 @@
      */
     private void setBurnRate(int par1, int par2, int par3)
     {
-        this.chanceToEncourageFire[par1] = par2;
-        this.abilityToCatchFire[par1] = par3;
+        Block.setBurnProperties(par1, par2, par3);
     }
 
     /**
@@ -123,21 +132,17 @@
     {
         if (par1World.getGameRules().getGameRuleBooleanValue("doFireTick"))
         {
-            boolean flag = par1World.getBlockId(par2, par3 - 1, par4) == Block.netherrack.blockID;
-
-            if (par1World.provider instanceof WorldProviderEnd && par1World.getBlockId(par2, par3 - 1, par4) == Block.bedrock.blockID)
-            {
-                flag = true;
-            }
+            Block base = Block.blocksList[par1World.getBlockId(par2, par3 - 1, par4)];
+            boolean flag = (base != null && base.isFireSource(par1World, par2, par3 - 1, par4, par1World.getBlockMetadata(par2, par3 - 1, par4), UP));
 
             if (!this.canPlaceBlockAt(par1World, par2, par3, par4))
             {
-                par1World.setBlockToAir(par2, par3, par4);
+                fireExtinguished(par1World, par2, par3, par4); // CraftBukkit - invalid place location
             }
 
             if (!flag && par1World.isRaining() && (par1World.canLightningStrikeAt(par2, par3, par4) || par1World.canLightningStrikeAt(par2 - 1, par3, par4) || par1World.canLightningStrikeAt(par2 + 1, par3, par4) || par1World.canLightningStrikeAt(par2, par3, par4 - 1) || par1World.canLightningStrikeAt(par2, par3, par4 + 1)))
             {
-                par1World.setBlockToAir(par2, par3, par4);
+                fireExtinguished(par1World, par2, par3, par4); // CraftBukkit - extinguished by rain
             }
             else
             {
@@ -157,9 +162,9 @@
                         par1World.setBlockToAir(par2, par3, par4);
                     }
                 }
-                else if (!flag && !this.canBlockCatchFire(par1World, par2, par3 - 1, par4) && l == 15 && par5Random.nextInt(4) == 0)
-                {
-                    par1World.setBlockToAir(par2, par3, par4);
+                else if (!flag && !this.canBlockCatchFire(par1World, par2, par3 - 1, par4, UP) && l == 15 && par5Random.nextInt(4) == 0)
+                {
+                    fireExtinguished(par1World, par2, par3, par4); // CraftBukkit - burn out
                 }
                 else
                 {
@@ -171,12 +176,12 @@
                         b0 = -50;
                     }
 
-                    this.tryToCatchBlockOnFire(par1World, par2 + 1, par3, par4, 300 + b0, par5Random, l);
-                    this.tryToCatchBlockOnFire(par1World, par2 - 1, par3, par4, 300 + b0, par5Random, l);
-                    this.tryToCatchBlockOnFire(par1World, par2, par3 - 1, par4, 250 + b0, par5Random, l);
-                    this.tryToCatchBlockOnFire(par1World, par2, par3 + 1, par4, 250 + b0, par5Random, l);
-                    this.tryToCatchBlockOnFire(par1World, par2, par3, par4 - 1, 300 + b0, par5Random, l);
-                    this.tryToCatchBlockOnFire(par1World, par2, par3, par4 + 1, 300 + b0, par5Random, l);
+                    this.tryToCatchBlockOnFire(par1World, par2 + 1, par3, par4, 300 + b0, par5Random, l, WEST );
+                    this.tryToCatchBlockOnFire(par1World, par2 - 1, par3, par4, 300 + b0, par5Random, l, EAST );
+                    this.tryToCatchBlockOnFire(par1World, par2, par3 - 1, par4, 250 + b0, par5Random, l, UP   );
+                    this.tryToCatchBlockOnFire(par1World, par2, par3 + 1, par4, 250 + b0, par5Random, l, DOWN );
+                    this.tryToCatchBlockOnFire(par1World, par2, par3, par4 - 1, 300 + b0, par5Random, l, SOUTH);
+                    this.tryToCatchBlockOnFire(par1World, par2, par3, par4 + 1, 300 + b0, par5Random, l, NORTH);
 
                     for (int i1 = par2 - 1; i1 <= par2 + 1; ++i1)
                     {
@@ -213,7 +218,29 @@
                                                 k2 = 15;
                                             }
 
-                                            par1World.setBlock(i1, k1, j1, this.blockID, k2, 3);
+                                            // CraftBukkit start - Call to stop spread of fire
+                                            if (par1World.getBlockId(i1, k1, j1) != Block.fire.blockID)
+                                            {
+                                                if (CraftEventFactory.callBlockIgniteEvent(par1World, i1, k1, j1, par2, par3, par4).isCancelled())
+                                                {
+                                                    continue;
+                                                }
+
+                                                org.bukkit.Server server = par1World.getServer();
+                                                org.bukkit.World bworld = par1World.getWorld();
+                                                org.bukkit.block.BlockState blockState = bworld.getBlockAt(i1, k1, j1).getState();
+                                                blockState.setTypeId(this.blockID);
+                                                blockState.setData(new org.bukkit.material.MaterialData(this.blockID, (byte) k2));
+                                                BlockSpreadEvent spreadEvent = new BlockSpreadEvent(blockState.getBlock(), bworld.getBlockAt(par2, par3, par4), blockState);
+                                                server.getPluginManager().callEvent(spreadEvent);
+
+                                                if (!spreadEvent.isCancelled())
+                                                {
+                                                    blockState.update(true);
+                                                }
+                                            }
+
+                                            // CraftBukkit end
                                         }
                                     }
                                 }
@@ -230,13 +257,35 @@
         return false;
     }
 
+    @Deprecated
     private void tryToCatchBlockOnFire(World par1World, int par2, int par3, int par4, int par5, Random par6Random, int par7)
     {
-        int j1 = this.abilityToCatchFire[par1World.getBlockId(par2, par3, par4)];
+        tryToCatchBlockOnFire(par1World, par2, par3, par4, par5, par6Random, par7, UP);
+    }
+
+    private void tryToCatchBlockOnFire(World par1World, int par2, int par3, int par4, int par5, Random par6Random, int par7, ForgeDirection face)
+    {
+        int j1 = 0;
+        Block block = Block.blocksList[par1World.getBlockId(par2, par3, par4)];
+        if (block != null)
+        {
+            j1 = block.getFlammability(par1World, par2, par3, par4, par1World.getBlockMetadata(par2, par3, par4), face);
+        }
 
         if (par6Random.nextInt(par5) < j1)
-        {
+        {    
             boolean flag = par1World.getBlockId(par2, par3, par4) == Block.tnt.blockID;
+            // CraftBukkit start
+            org.bukkit.block.Block theBlock = par1World.getWorld().getBlockAt(par2, par3, par4);
+            BlockBurnEvent event = new BlockBurnEvent(theBlock);
+            par1World.getServer().getPluginManager().callEvent(event);
+
+            if (event.isCancelled())
+            {
+                return;
+            }
+
+            // CraftBukkit end
 
             if (par6Random.nextInt(par7 + 10) < 5 && !par1World.canLightningStrikeAt(par2, par3, par4))
             {
@@ -266,7 +315,12 @@
      */
     private boolean canNeighborBurn(World par1World, int par2, int par3, int par4)
     {
-        return this.canBlockCatchFire(par1World, par2 + 1, par3, par4) ? true : (this.canBlockCatchFire(par1World, par2 - 1, par3, par4) ? true : (this.canBlockCatchFire(par1World, par2, par3 - 1, par4) ? true : (this.canBlockCatchFire(par1World, par2, par3 + 1, par4) ? true : (this.canBlockCatchFire(par1World, par2, par3, par4 - 1) ? true : this.canBlockCatchFire(par1World, par2, par3, par4 + 1)))));
+        return canBlockCatchFire(par1World, par2 + 1, par3, par4, WEST ) ||
+               canBlockCatchFire(par1World, par2 - 1, par3, par4, EAST ) ||
+               canBlockCatchFire(par1World, par2, par3 - 1, par4, UP   ) ||
+               canBlockCatchFire(par1World, par2, par3 + 1, par4, DOWN ) ||
+               canBlockCatchFire(par1World, par2, par3, par4 - 1, SOUTH) ||
+               canBlockCatchFire(par1World, par2, par3, par4 + 1, NORTH);
     }
 
     /**
@@ -282,12 +336,12 @@
         }
         else
         {
-            int l = this.getChanceToEncourageFire(par1World, par2 + 1, par3, par4, b0);
-            l = this.getChanceToEncourageFire(par1World, par2 - 1, par3, par4, l);
-            l = this.getChanceToEncourageFire(par1World, par2, par3 - 1, par4, l);
-            l = this.getChanceToEncourageFire(par1World, par2, par3 + 1, par4, l);
-            l = this.getChanceToEncourageFire(par1World, par2, par3, par4 - 1, l);
-            l = this.getChanceToEncourageFire(par1World, par2, par3, par4 + 1, l);
+            int l = this.getChanceToEncourageFire(par1World, par2 + 1, par3, par4, b0, WEST);
+            l = this.getChanceToEncourageFire(par1World, par2 - 1, par3, par4, l, EAST);
+            l = this.getChanceToEncourageFire(par1World, par2, par3 - 1, par4, l, UP);
+            l = this.getChanceToEncourageFire(par1World, par2, par3 + 1, par4, l, DOWN);
+            l = this.getChanceToEncourageFire(par1World, par2, par3, par4 - 1, l, SOUTH);
+            l = this.getChanceToEncourageFire(par1World, par2, par3, par4 + 1, l, NORTH);
             return l;
         }
     }
@@ -302,21 +356,24 @@
 
     /**
      * Checks the specified block coordinate to see if it can catch fire.  Args: blockAccess, x, y, z
-     */
+     * Deprecated for a side-sensitive version
+     */
+    @Deprecated
     public boolean canBlockCatchFire(IBlockAccess par1IBlockAccess, int par2, int par3, int par4)
     {
-        return this.chanceToEncourageFire[par1IBlockAccess.getBlockId(par2, par3, par4)] > 0;
+        return canBlockCatchFire(par1IBlockAccess, par2, par3, par4, UP);
     }
 
     /**
      * Retrieves a specified block's chance to encourage their neighbors to burn and if the number is greater than the
      * current number passed in it will return its number instead of the passed in one.  Args: world, x, y, z,
      * curChanceToEncourageFire
-     */
+     * Deprecated for a side-sensitive version
+     */
+    @Deprecated
     public int getChanceToEncourageFire(World par1World, int par2, int par3, int par4, int par5)
     {
-        int i1 = this.chanceToEncourageFire[par1World.getBlockId(par2, par3, par4)];
-        return i1 > par5 ? i1 : par5;
+        return getChanceToEncourageFire(par1World, par2, par3, par4, par5, UP);
     }
 
     /**
@@ -335,7 +392,7 @@
     {
         if (!par1World.doesBlockHaveSolidTopSurface(par2, par3 - 1, par4) && !this.canNeighborBurn(par1World, par2, par3, par4))
         {
-            par1World.setBlockToAir(par2, par3, par4);
+            fireExtinguished(par1World, par2, par3, par4); // CraftBukkit - fuel block gone
         }
     }
 
@@ -348,7 +405,7 @@
         {
             if (!par1World.doesBlockHaveSolidTopSurface(par2, par3 - 1, par4) && !this.canNeighborBurn(par1World, par2, par3, par4))
             {
-                par1World.setBlockToAir(par2, par3, par4);
+                fireExtinguished(par1World, par2, par3, par4); // CraftBukkit - fuel block broke
             }
             else
             {
@@ -374,9 +431,9 @@
         float f1;
         float f2;
 
-        if (!par1World.doesBlockHaveSolidTopSurface(par2, par3 - 1, par4) && !Block.fire.canBlockCatchFire(par1World, par2, par3 - 1, par4))
-        {
-            if (Block.fire.canBlockCatchFire(par1World, par2 - 1, par3, par4))
+        if (!par1World.doesBlockHaveSolidTopSurface(par2, par3 - 1, par4) && !Block.fire.canBlockCatchFire(par1World, par2, par3 - 1, par4, UP))
+        {
+            if (Block.fire.canBlockCatchFire(par1World, par2 - 1, par3, par4, EAST))
             {
                 for (l = 0; l < 2; ++l)
                 {
@@ -387,7 +444,7 @@
                 }
             }
 
-            if (Block.fire.canBlockCatchFire(par1World, par2 + 1, par3, par4))
+            if (Block.fire.canBlockCatchFire(par1World, par2 + 1, par3, par4, WEST))
             {
                 for (l = 0; l < 2; ++l)
                 {
@@ -398,7 +455,7 @@
                 }
             }
 
-            if (Block.fire.canBlockCatchFire(par1World, par2, par3, par4 - 1))
+            if (Block.fire.canBlockCatchFire(par1World, par2, par3, par4 - 1, SOUTH))
             {
                 for (l = 0; l < 2; ++l)
                 {
@@ -409,7 +466,7 @@
                 }
             }
 
-            if (Block.fire.canBlockCatchFire(par1World, par2, par3, par4 + 1))
+            if (Block.fire.canBlockCatchFire(par1World, par2, par3, par4 + 1, NORTH))
             {
                 for (l = 0; l < 2; ++l)
                 {
@@ -420,7 +477,7 @@
                 }
             }
 
-            if (Block.fire.canBlockCatchFire(par1World, par2, par3 + 1, par4))
+            if (Block.fire.canBlockCatchFire(par1World, par2, par3 + 1, par4, DOWN))
             {
                 for (l = 0; l < 2; ++l)
                 {
@@ -451,11 +508,11 @@
      */
     public void registerIcons(IconRegister par1IconRegister)
     {
-        this.iconArray = new Icon[] {par1IconRegister.registerIcon(this.func_111023_E() + "_layer_0"), par1IconRegister.registerIcon(this.func_111023_E() + "_layer_1")};
+        this.iconArray = new Icon[] {par1IconRegister.registerIcon(this.getTextureName() + "_layer_0"), par1IconRegister.registerIcon(this.getTextureName() + "_layer_1")};
     }
 
     @SideOnly(Side.CLIENT)
-    public Icon func_94438_c(int par1)
+    public Icon getFireIcon(int par1)
     {
         return this.iconArray[par1];
     }
@@ -469,4 +526,56 @@
     {
         return this.iconArray[0];
     }
+
+    // CraftBukkit start
+    private void fireExtinguished(World world, int x, int y, int z)
+    {
+        if (!CraftEventFactory.callBlockFadeEvent(world.getWorld().getBlockAt(x, y, z), 0).isCancelled())
+        {
+            world.setBlockToAir(x, y, z);
+        }
+    }
+    // CraftBukkit end
+    
+    /**
+     * Side sensitive version that calls the block function.
+     * 
+     * @param world The current world
+     * @param x X Position
+     * @param y Y Position
+     * @param z Z Position
+     * @param face The side the fire is coming from
+     * @return True if the face can catch fire.
+     */
+    public boolean canBlockCatchFire(IBlockAccess world, int x, int y, int z, ForgeDirection face)
+    {
+        Block block = Block.blocksList[world.getBlockId(x, y, z)];
+        if (block != null)
+        {
+            return block.isFlammable(world, x, y, z, world.getBlockMetadata(x, y, z), face);
+        }
+        return false;
+    }
+
+    /**
+     * Side sensitive version that calls the block function.
+     * 
+     * @param world The current world
+     * @param x X Position
+     * @param y Y Position
+     * @param z Z Position
+     * @param oldChance The previous maximum chance.
+     * @param face The side the fire is coming from
+     * @return The chance of the block catching fire, or oldChance if it is higher
+     */
+    public int getChanceToEncourageFire(World world, int x, int y, int z, int oldChance, ForgeDirection face)
+    {
+        int newChance = 0;
+        Block block = Block.blocksList[world.getBlockId(x, y, z)];
+        if (block != null)
+        {
+            newChance = block.getFireSpreadSpeed(world, x, y, z, world.getBlockMetadata(x, y, z), face);
+        }
+        return (newChance > oldChance ? newChance : oldChance);
+    }
 }
