--- ../src_base/minecraft/net/minecraft/entity/ai/EntityAIRunAroundLikeCrazy.java
+++ ../src_work/minecraft/net/minecraft/entity/ai/EntityAIRunAroundLikeCrazy.java
@@ -7,7 +7,7 @@
 
 public class EntityAIRunAroundLikeCrazy extends EntityAIBase
 {
-    private EntityHorse field_111180_a;
+    private EntityHorse horseHost;
     private double field_111178_b;
     private double field_111179_c;
     private double field_111176_d;
@@ -15,7 +15,7 @@
 
     public EntityAIRunAroundLikeCrazy(EntityHorse par1EntityHorse, double par2)
     {
-        this.field_111180_a = par1EntityHorse;
+        this.horseHost = par1EntityHorse;
         this.field_111178_b = par2;
         this.setMutexBits(1);
     }
@@ -25,9 +25,9 @@
      */
     public boolean shouldExecute()
     {
-        if (!this.field_111180_a.func_110248_bS() && this.field_111180_a.riddenByEntity != null)
+        if (!this.horseHost.isTame() && this.horseHost.riddenByEntity != null)
         {
-            Vec3 vec3 = RandomPositionGenerator.findRandomTarget(this.field_111180_a, 5, 4);
+            Vec3 vec3 = RandomPositionGenerator.findRandomTarget(this.horseHost, 5, 4);
 
             if (vec3 == null)
             {
@@ -52,7 +52,7 @@
      */
     public void startExecuting()
     {
-        this.field_111180_a.getNavigator().tryMoveToXYZ(this.field_111179_c, this.field_111176_d, this.field_111177_e, this.field_111178_b);
+        this.horseHost.getNavigator().tryMoveToXYZ(this.field_111179_c, this.field_111176_d, this.field_111177_e, this.field_111178_b);
     }
 
     /**
@@ -60,7 +60,7 @@
      */
     public boolean continueExecuting()
     {
-        return !this.field_111180_a.getNavigator().noPath() && this.field_111180_a.riddenByEntity != null;
+        return !this.horseHost.getNavigator().noPath() && this.horseHost.riddenByEntity != null;
     }
 
     /**
@@ -68,27 +68,39 @@
      */
     public void updateTask()
     {
-        if (this.field_111180_a.getRNG().nextInt(50) == 0)
+        if (this.horseHost.getRNG().nextInt(50) == 0)
         {
-            if (this.field_111180_a.riddenByEntity instanceof EntityPlayer)
+            if (this.horseHost.riddenByEntity instanceof EntityPlayer)
             {
-                int i = this.field_111180_a.func_110252_cg();
-                int j = this.field_111180_a.func_110218_cm();
+                int i = this.horseHost.getTemper();
+                int j = this.horseHost.getMaxTemper();
 
-                if (j > 0 && this.field_111180_a.getRNG().nextInt(j) < i)
+                if (j > 0 && this.horseHost.getRNG().nextInt(j) < i)
                 {
-                    this.field_111180_a.func_110263_g((EntityPlayer)this.field_111180_a.riddenByEntity);
-                    this.field_111180_a.worldObj.setEntityState(this.field_111180_a, (byte)7);
+                    this.horseHost.setTamedBy((EntityPlayer)this.horseHost.riddenByEntity);
+                    this.horseHost.worldObj.setEntityState(this.horseHost, (byte)7);
                     return;
                 }
 
-                this.field_111180_a.func_110198_t(5);
+                this.horseHost.increaseTemper(5);
             }
 
-            this.field_111180_a.riddenByEntity.mountEntity((Entity)null);
-            this.field_111180_a.riddenByEntity = null;
-            this.field_111180_a.func_110231_cz();
-            this.field_111180_a.worldObj.setEntityState(this.field_111180_a, (byte)6);
+            // CraftBukkit start - Handle dismounting to account for VehicleExitEvent being fired.
+            if (this.horseHost.riddenByEntity != null)
+            {
+                this.horseHost.riddenByEntity.mountEntity((Entity)null);
+
+                // If the entity still has a passenger, then a plugin cancelled the event.
+                if (this.horseHost.riddenByEntity != null)
+                {
+                    return;
+                }
+            }
+
+            // this.field_111180_a.riddenByEntity = null;
+            // CraftBukkit end
+            this.horseHost.makeHorseRearWithSound();
+            this.horseHost.worldObj.setEntityState(this.horseHost, (byte)6);
         }
     }
 }
