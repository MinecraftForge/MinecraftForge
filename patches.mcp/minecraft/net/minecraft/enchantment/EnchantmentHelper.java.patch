--- ../src-base/minecraft/net/minecraft/enchantment/EnchantmentHelper.java
+++ ../src-work/minecraft/net/minecraft/enchantment/EnchantmentHelper.java
@@ -308,7 +308,7 @@
     public static int calcItemStackEnchantability(Random p_77514_0_, int p_77514_1_, int p_77514_2_, ItemStack p_77514_3_)
     {
         Item item = p_77514_3_.getItem();
-        int k = item.getItemEnchantability();
+        int k = item.getItemEnchantability(p_77514_3_);
 
         if (k <= 0)
         {
@@ -361,7 +361,7 @@
     public static List buildEnchantmentList(Random p_77513_0_, ItemStack p_77513_1_, int p_77513_2_)
     {
         Item item = p_77513_1_.getItem();
-        int j = item.getItemEnchantability();
+        int j = item.getItemEnchantability(p_77513_1_);
 
         if (j <= 0)
         {
@@ -408,7 +408,9 @@
                                 {
                                     EnchantmentData enchantmentdata1 = (EnchantmentData)iterator1.next();
 
-                                    if (enchantmentdata1.enchantmentobj.canApplyTogether(Enchantment.getEnchantmentById(integer.intValue())))
+                                    Enchantment e1 = enchantmentdata1.enchantmentobj;
+                                    Enchantment e2 = Enchantment.getEnchantmentById(integer.intValue());
+                                    if (e1.canApplyTogether(e2) && e2.canApplyTogether(e1)) //Forge BugFix: Let Both enchantments veto being together
                                     {
                                         continue;
                                     }
@@ -450,7 +452,8 @@
         {
             Enchantment enchantment = aenchantment[k];
 
-            if (enchantment != null && (enchantment.type.canEnchantItem(item) || flag))
+            if (enchantment == null) continue;
+            if (enchantment.canApplyAtEnchantingTable(p_77505_1_) || ((item == Items.book) && enchantment.isAllowedOnBooks()))
             {
                 for (int l = enchantment.getMinLevel(); l <= enchantment.getMaxLevel(); ++l)
                 {
